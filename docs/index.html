<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpeakNode â€” Knowledge Graph Demo</title>
    <meta name="description" content="Local-first AI meeting knowledge extraction and graph visualization demo">
    <style>
        body {
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1a1a1a;
            color: #ffffff;
            overflow: hidden;
        }

        .main-container {
            display: flex;
            height: 100vh;
            flex-direction: column;
        }

        .header {
            background: rgba(0, 0, 0, 0.85);
            padding: 12px 20px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
            flex-shrink: 0;
        }

        .header h1 {
            margin: 0;
            color: white;
            font-size: 1.8em;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .header-title-wrap {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            position: relative;
        }

        .header-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 8px;
        }

        .header-links a {
            color: #60a5fa;
            text-decoration: none;
            font-size: 0.9em;
            padding: 5px 10px;
            border: 1px solid #60a5fa;
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        .header-links a:hover {
            background: #60a5fa;
            color: white;
        }

        .content-container {
            display: flex;
            flex: 1;
            overflow: visible;
            min-height: 0;
        }

        .left-panel {
            width: 280px;
            background: rgba(0, 0, 0, 0.7);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            padding: 20px;
            overflow-y: auto;
            overflow-x: visible;
            flex-shrink: 0;
            min-height: 0;
            -webkit-overflow-scrolling: touch;
        }

        .center-panel {
            flex: 1;
            position: relative;
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1;
        }

        .right-panel {
            width: 300px;
            background: rgba(0, 0, 0, 0.7);
            border-left: 1px solid rgba(255, 255, 255, 0.1);
            padding: 20px;
            overflow-y: auto;
            flex-shrink: 0;
            z-index: 1;
        }

        .guidance {
            color: #e5e7eb;
        }

        .guidance h2 {
            color: #ffffff;
            margin-top: 0;
            font-size: 1.3em;
            border-bottom: 2px solid #60a5fa;
            padding-bottom: 8px;
            margin-bottom: 20px;
        }

        .gui-container h2 {
            color: #ffffff;
            margin-top: 0;
            font-size: 1.3em;
            border-bottom: 2px solid #60fae5;
            padding-bottom: 8px;
            margin-bottom: 20px;
        }

        .step {
            margin: 10px 0;
            padding: 10px 12px;
            background: rgba(96, 165, 250, 0.08);
            border-radius: 6px;
            border-left: 2px solid #60a5fa;
        }

        .step h3 {
            margin: 0 0 8px 0;
            color: #ffffff;
            font-size: 1em;
        }

        .step p {
            margin: 4px 0;
            line-height: 1.4;
            font-size: 0.85em;
            color: #d1d5db;
        }

        .controls-info {
            background: rgba(168, 85, 247, 0.08);
            border-left: 2px solid #a855f7;
        }

        .keyboard-shortcuts {
            background: rgba(34, 197, 94, 0.08);
            border-left: 2px solid #22c55e;
        }

        /* Info tooltip */
        .info-tip {
            display: inline-block;
            position: relative;
            margin-left: 8px;
            width: 16px;
            height: 16px;
            line-height: 16px;
            text-align: center;
            border-radius: 50%;
            background: #3b82f6;
            color: #fff;
            font-size: 12px;
            cursor: default;
            user-select: none;
            z-index: 100000;
        }

        .info-tip .tooltip {
            display: none;
            position: absolute;
            left: 0;
            top: calc(100% + 8px);
            transform: none;
            background: rgba(0, 0, 0, 0.95);
            color: #e5e7eb;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 10px 12px;
            font-size: 12px;
            width: 480px;
            white-space: normal;
            z-index: 999999;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.6);
            text-align: left;
        }

        .info-tip:hover .tooltip {
            display: block;
        }

        .status-bar {
            background: rgba(0, 0, 0, 0.9);
            color: #60a5fa;
            padding: 8px 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.8em;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            flex-shrink: 0;
        }

        .canvas-container {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #111111;
            position: relative;
        }

        /* Progress & status beautify */
        .progress-container {
            width: 100%;
            height: 18px;
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.06), rgba(255, 255, 255, 0.02));
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 999px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.35) inset;
            position: relative;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #60a5fa, #8b5cf6);
            position: relative;
            transition: width .15s ease;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 11px;
            color: #f8fafc;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
            pointer-events: none;
            white-space: nowrap;
        }

        .status-badges {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 8px;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 10px;
            border-radius: 8px;
            font-size: 12px;
            border: 1px solid rgba(255, 255, 255, 0.12);
            background: rgba(255, 255, 255, 0.06);
        }

        .badge .dot {
            width: 8px;
            height: 8px;
            border-radius: 999px;
        }

        .badge.meeting .dot {
            background: #60a5fa;
            box-shadow: 0 0 3px #60a5fa;
        }

        .badge.person .dot {
            background: #a855f7;
            box-shadow: 0 0 3px #a855f7;
        }

        .badge.topic .dot {
            background: #22c55e;
            box-shadow: 0 0 3px #22c55e;
        }

        .badge.task .dot {
            background: #f59e0b;
            box-shadow: 0 0 3px #f59e0b;
        }

        .badge.decision .dot {
            background: #f472b6;
            box-shadow: 0 0 3px #f472b6;
        }

        .badge.utterance .dot {
            background: #06b6d4;
            box-shadow: 0 0 3px #06b6d4;
        }

        .badge.entity .dot {
            background: #ec4899;
            box-shadow: 0 0 3px #ec4899;
        }

        .details-grid {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 6px 12px;
            margin-top: 8px;
            font-size: 12px;
            color: #cbd5e1;
        }

        .details-grid div {
            opacity: 0.9;
        }

        /* GUI Panel Styling */
        .gui-panel {
            background: rgba(0, 0, 0, 0.8);
            border-radius: 8px;
            padding: 15px;
            min-height: 400px;
        }

        /* Node detail card */
        .node-detail-card {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 8px;
            padding: 12px;
            margin-top: 10px;
            display: none;
        }

        .node-detail-card.visible {
            display: block;
        }

        .node-detail-card h4 {
            margin: 0 0 8px 0;
            font-size: 0.95em;
        }

        .node-detail-card .field {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.06);
            font-size: 0.8em;
        }

        .node-detail-card .field-label {
            color: #9ca3af;
        }

        @media (max-width: 1200px) {
            .left-panel {
                width: 250px;
            }

            .right-panel {
                width: 280px;
            }
        }

        @media (max-width: 768px) {
            .content-container {
                flex-direction: column;
            }

            .left-panel,
            .right-panel {
                width: 100%;
                height: auto;
                max-height: 200px;
            }

            .center-panel {
                flex: 1;
                min-height: 400px;
            }
        }
    </style>
</head>

<body>
    <div class="main-container">
        <!-- Header Section -->
        <header class="header">
            <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                <h1 style="margin: 0; flex: 1; text-align: left;">
                    <span class="header-title-wrap">SpeakNode Knowledge Graph
                        <span class="info-tip">!
                            <span class="tooltip" style="max-width: 320px; text-align: left;">SpeakNodeëŠ” ìŒì„±ì„ ë¶„ì„í•˜ì—¬
                                êµ¬ì¡°í™”ëœ ì§€ì‹ ê·¸ë˜í”„ë¥¼ ìƒì„±í•˜ëŠ” ë¡œì»¬ ìš°ì„ (Local-first) AI ì‹œìŠ¤í…œì…ë‹ˆë‹¤. ì•„ë˜ ê·¸ë˜í”„ëŠ” ì‹¤ì œ ìŠ¤í‚¤ë§ˆ ê¸°ë°˜ì˜ ë°ëª¨ ë°ì´í„°ì…ë‹ˆë‹¤.
                            </span>
                        </span>
                    </span>
                </h1>
                <div class="header-links" style="margin-left: 20px;">
                    <a href="https://github.com/Kinder1203/SpeakNode" target="_blank">GitHub</a>
                </div>
            </div>
        </header>

        <!-- Main Content Container -->
        <div class="content-container">
            <!-- Left Panel: Project Info -->
            <div class="left-panel">
                <div class="guidance">
                    <h2>Overview</h2>

                    <div class="step">
                        <h3>1. Transcribe</h3>
                        <p>Faster-Whisperë¡œ ìŒì„±ì„ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜ (pyannote í™”ì ë¶„ë¦¬ ì§€ì›)</p>
                    </div>

                    <div class="step">
                        <h3>2. Embed</h3>
                        <p>all-MiniLM-L6-v2 ëª¨ë¸ë¡œ ë°œí™” ë²¡í„° ì„ë² ë”© (384ì°¨ì›)</p>
                    </div>

                    <div class="step">
                        <h3>3. Extract</h3>
                        <p>Ollama + LangChainìœ¼ë¡œ í† í”½, ê²°ì •, íƒœìŠ¤í¬, ì¸ë¬¼, ì—”í‹°í‹°, ê´€ê³„ êµ¬ì¡°í™” ì¶”ì¶œ</p>
                    </div>

                    <div class="step">
                        <h3>4. Store</h3>
                        <p>KuzuDB ê·¸ë˜í”„ ë°ì´í„°ë² ì´ìŠ¤ì— íšŒì˜ ìŠ¤ì½”í”„ í‚¤ë¡œ ì €ì¥</p>
                    </div>

                    <div class="step">
                        <h3>5. Query</h3>
                        <p>Hybrid RAG (ë²¡í„° + ê·¸ë˜í”„ + Cypher) + LangGraph Agent ê²€ìƒ‰</p>
                    </div>

                    <div class="step">
                        <h3>6. Share</h3>
                        <p>PNG ë©”íƒ€ë°ì´í„°ì— ê·¸ë˜í”„ ë¤í”„ë¥¼ ì••ì¶• ë‚´ì¥í•˜ì—¬ ê³µìœ </p>
                    </div>

                    <div class="step controls-info">
                        <h3>Graph Controls</h3>
                        <p><strong>Click:</strong> ë…¸ë“œ ìƒì„¸ ì •ë³´ ë³´ê¸°</p>
                        <p><strong>Double-click:</strong> ë…¸ë“œ í¬ì»¤ìŠ¤ ì¤Œ</p>
                        <p><strong>Drag:</strong> ë…¸ë“œ ì´ë™ / í™”ë©´ ì´ë™</p>
                        <p><strong>Scroll:</strong> í™•ëŒ€ / ì¶•ì†Œ</p>
                    </div>

                    <div class="step keyboard-shortcuts">
                        <h3>Tech Stack</h3>
                        <p><strong>Core:</strong> Python 3.10+, KuzuDB, LangGraph</p>
                        <p><strong>LLM:</strong> Ollama, LangChain</p>
                        <p><strong>STT:</strong> Faster-Whisper, pyannote</p>
                        <p><strong>Client:</strong> Kotlin Compose, Ktor</p>
                        <p><strong>API:</strong> FastAPI, Uvicorn</p>
                    </div>
                </div>
            </div>

            <!-- Center Panel: Graph Visualization -->
            <div class="center-panel">
                <div class="canvas-container" id="canvas-container">
                    <div id="graph-canvas" style="width: 100%; height: 100%;"></div>
                </div>
            </div>

            <!-- Right Panel: Node Info & Legend -->
            <div class="right-panel">
                <div class="gui-container">
                    <h2>Graph Schema</h2>
                    <div class="gui-panel" id="gui-container">
                        <!-- Legend -->
                        <p style="font-size: 0.85em; color: #9ca3af; margin-bottom: 12px;">SpeakNode KuzuDB ê·¸ë˜í”„ ìŠ¤í‚¤ë§ˆ ê¸°ë°˜
                            ë°ëª¨</p>
                        <div style="font-size: 0.85em; font-weight: 600; margin-bottom: 8px;">Node Types</div>
                        <div class="status-badges">
                            <div class="badge meeting"><span class="dot"></span>Meeting</div>
                            <div class="badge person"><span class="dot"></span>Person</div>
                            <div class="badge topic"><span class="dot"></span>Topic</div>
                            <div class="badge task"><span class="dot"></span>Task</div>
                            <div class="badge decision"><span class="dot"></span>Decision</div>
                            <div class="badge utterance"><span class="dot"></span>Utterance</div>
                            <div class="badge entity"><span class="dot"></span>Entity</div>
                        </div>

                        <div style="font-size: 0.85em; font-weight: 600; margin: 16px 0 8px;">Relationships</div>
                        <div class="details-grid">
                            <div>DISCUSSED</div>
                            <div style="color:#60a5fa">Meetingâ†’Topic</div>
                            <div>PROPOSED</div>
                            <div style="color:#a855f7">Personâ†’Topic</div>
                            <div>ASSIGNED_TO</div>
                            <div style="color:#f59e0b">Personâ†’Task</div>
                            <div>RESULTED_IN</div>
                            <div style="color:#f472b6">Topicâ†’Decision</div>
                            <div>SPOKE</div>
                            <div style="color:#06b6d4">Personâ†’Utterance</div>
                            <div>CONTAINS</div>
                            <div style="color:#60a5fa">Meetingâ†’Utterance</div>
                            <div>HAS_TASK</div>
                            <div style="color:#f59e0b">Meetingâ†’Task</div>
                            <div>HAS_DECISION</div>
                            <div style="color:#f472b6">Meetingâ†’Decision</div>
                            <div>NEXT</div>
                            <div style="color:#06b6d4">Utteranceâ†’Utterance</div>
                            <div>RELATED_TO</div>
                            <div style="color:#ec4899">Entityâ†’Entity</div>
                            <div>MENTIONS</div>
                            <div style="color:#22c55e">Topicâ†’Entity</div>
                            <div>HAS_ENTITY</div>
                            <div style="color:#ec4899">Meetingâ†’Entity</div>
                        </div>

                        <div style="font-size: 0.85em; font-weight: 600; margin: 16px 0 8px;">Statistics</div>
                        <div class="details-grid">
                            <div>Nodes</div>
                            <div id="stat-nodes">â€”</div>
                            <div>Edges</div>
                            <div id="stat-edges">â€”</div>
                            <div>Node Types</div>
                            <div>7</div>
                            <div>Rel Types</div>
                            <div>12</div>
                        </div>
                    </div>
                </div>

                <!-- Node Detail -->
                <div class="node-detail-card" id="node-detail">
                    <h4 id="detail-title">Select a node</h4>
                    <div id="detail-fields"></div>
                </div>
            </div>
        </div>

        <!-- Status Bar -->
        <div class="status-bar" id="status-bar">
            SpeakNode Knowledge Graph | Nodes: 0 | Edges: 0 | Status: Initializing
        </div>
    </div>

    <script src="https://unpkg.com/vis-network@9.1.9/standalone/umd/vis-network.min.js"></script>
    <script>
        // Node & Edge Style Definitions
        const NODE_CFG = {
            Meeting: { color: '#60a5fa', glow: 'rgba(96,165,250,0.4)', size: 30, icon: 'ğŸ“…' },
            Person: { color: '#a855f7', glow: 'rgba(168,85,247,0.4)', size: 22, icon: 'ğŸ‘¤' },
            Topic: { color: '#22c55e', glow: 'rgba(34,197,94,0.4)', size: 20, icon: 'ğŸ’¡' },
            Task: { color: '#f59e0b', glow: 'rgba(245,158,11,0.4)', size: 18, icon: 'âœ…' },
            Decision: { color: '#f472b6', glow: 'rgba(244,114,182,0.4)', size: 18, icon: 'âš–ï¸' },
            Utterance: { color: '#06b6d4', glow: 'rgba(6,182,212,0.3)', size: 12, icon: 'ğŸ’¬' },
            Entity: { color: '#ec4899', glow: 'rgba(236,72,153,0.35)', size: 16, icon: 'ğŸ”—' }
        };

        const EDGE_CFG = {
            DISCUSSED: { color: 'rgba(96,165,250,0.5)', w: 2, dash: false },
            PROPOSED: { color: 'rgba(168,85,247,0.5)', w: 2, dash: false },
            ASSIGNED_TO: { color: 'rgba(245,158,11,0.5)', w: 2, dash: [5, 5] },
            RESULTED_IN: { color: 'rgba(244,114,182,0.5)', w: 2, dash: false },
            SPOKE: { color: 'rgba(6,182,212,0.35)', w: 1, dash: false },
            CONTAINS: { color: 'rgba(96,165,250,0.25)', w: 1, dash: [3, 3] },
            HAS_TASK: { color: 'rgba(245,158,11,0.35)', w: 1.5, dash: false },
            HAS_DECISION: { color: 'rgba(244,114,182,0.35)', w: 1.5, dash: false },
            NEXT: { color: 'rgba(6,182,212,0.2)', w: 1, dash: [2, 4] },
            RELATED_TO: { color: 'rgba(236,72,153,0.4)', w: 1.5, dash: [4, 4] },
            MENTIONS: { color: 'rgba(34,197,94,0.35)', w: 1, dash: [3, 3] },
            HAS_ENTITY: { color: 'rgba(236,72,153,0.3)', w: 1, dash: false }
        };

        function mkNode(id, label, type, extra) {
            const c = NODE_CFG[type];
            return {
                id, label: c.icon + ' ' + label, group: type,
                color: {
                    background: c.glow, border: c.color,
                    highlight: { background: c.color, border: '#fff' },
                    hover: { background: c.color, border: '#fff' }
                },
                borderWidth: 1.5, borderWidthSelected: 2.5,
                shadow: { enabled: true, color: c.glow, size: 8, x: 0, y: 0 },
                font: { color: '#e5e7eb', size: 12, face: "'Segoe UI',sans-serif", strokeWidth: 0 },
                shape: 'dot', size: c.size,
                _type: type, _extra: extra || {}
            };
        }

        function mkEdge(from, to, rel) {
            const c = EDGE_CFG[rel] || { color: 'rgba(255,255,255,0.2)', w: 1, dash: false };
            return {
                from, to, label: rel,
                color: { color: c.color, highlight: '#fff', hover: '#fff' },
                width: c.w, dashes: c.dash,
                font: { color: 'rgba(255,255,255,0.25)', size: 8, strokeWidth: 0, align: 'middle' },
                smooth: { type: 'continuous', roundness: 0.3 },
                arrows: { to: { enabled: true, scaleFactor: 0.4 } },
                shadow: false
            };
        }

        // Demo Data (based on schema)
        const nodes = new vis.DataSet([
            mkNode('m1', 'ì£¼ê°„ ê¸°íš íšŒì˜', 'Meeting', { date: '2025-02-10', source: 'weekly.wav' }),
            mkNode('m2', 'ë””ìì¸ ë¦¬ë·°', 'Meeting', { date: '2025-02-12', source: 'design.mp3' }),

            mkNode('p1', 'ê¹€íƒœí˜¸', 'Person', { role: 'PM' }),
            mkNode('p2', 'ì´ì„œì—°', 'Person', { role: 'Developer' }),
            mkNode('p3', 'ë°•ì¤€í˜', 'Person', { role: 'Designer' }),
            mkNode('p4', 'ìµœìœ ì§„', 'Person', { role: 'Data Engineer' }),

            mkNode('t1', 'API ì„œë²„ ë§ˆì´ê·¸ë ˆì´ì…˜', 'Topic', { summary: 'FastAPI v5.2.0 ì—…ê·¸ë ˆì´ë“œ ë…¼ì˜' }),
            mkNode('t2', 'ëª¨ë°”ì¼ UI ê°œì„ ', 'Topic', { summary: 'Material 3 ë‹¤í¬ í…Œë§ˆ ì ìš©' }),
            mkNode('t3', 'RAG íŒŒì´í”„ë¼ì¸ ìµœì í™”', 'Topic', { summary: 'Hybrid RAG ì •í™•ë„ ê°œì„ ' }),
            mkNode('t4', 'ê·¸ë˜í”„ ìŠ¤í‚¤ë§ˆ í™•ì¥', 'Topic', { summary: 'ê°ì • ë¶„ì„ ë…¸ë“œ ì¶”ê°€ ë…¼ì˜' }),

            mkNode('tk1', 'Ktor í´ë¼ì´ì–¸íŠ¸ ì—…ë°ì´íŠ¸', 'Task', { deadline: '2025-02-20', status: 'in_progress' }),
            mkNode('tk2', 'ë²¡í„° ì¸ë±ìŠ¤ ë²¤ì¹˜ë§ˆí¬', 'Task', { deadline: '2025-02-18', status: 'pending' }),
            mkNode('tk3', 'UI í”„ë¡œí† íƒ€ì… ì œì‘', 'Task', { deadline: '2025-02-15', status: 'done' }),
            mkNode('tk4', 'Cypher ì¿¼ë¦¬ ìµœì í™”', 'Task', { deadline: '2025-02-22', status: 'pending' }),

            mkNode('d1', 'API v5.2.0 ì¦‰ì‹œ ë§ˆì´ê·¸ë ˆì´ì…˜', 'Decision', {}),
            mkNode('d2', 'Material 3 ë‹¤í¬ í…Œë§ˆ ì±„íƒ', 'Decision', {}),

            mkNode('u1', 'ì„œë²„ ë§ˆì´ê·¸ë ˆì´ì…˜ì€ ì´ë²ˆ ì£¼ì— ì‹œì‘í•©ì‹œë‹¤', 'Utterance', { start: 12.5, end: 16.2 }),
            mkNode('u2', 'ë²¡í„° ê²€ìƒ‰ ì„±ëŠ¥ì´ 30% í–¥ìƒë˜ì—ˆìŠµë‹ˆë‹¤', 'Utterance', { start: 45.1, end: 50.3 }),
            mkNode('u3', 'UIëŠ” Material 3ìœ¼ë¡œ í†µì¼í•˜ì£ ', 'Utterance', { start: 68.0, end: 72.5 }),
            mkNode('u4', 'RAGì— Cypher ì¿¼ë¦¬ë¥¼ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤', 'Utterance', { start: 91.2, end: 97.8 }),
            mkNode('u5', 'ê°ì • ë¶„ì„ ë…¸ë“œ ì¶”ê°€í•˜ëŠ” ê±´ ì–´ë–¤ê°€ìš”', 'Utterance', { start: 120.0, end: 125.5 }),
            mkNode('u6', 'ë””ìì¸ í”„ë¡œí† íƒ€ì… ì™„ë£Œ ë³´ê³ í•©ë‹ˆë‹¤', 'Utterance', { start: 150.3, end: 155.0 }),

            // Entity nodes (technology / concept / organization / event)
            mkNode('e1', 'FastAPI', 'Entity', { entity_type: 'technology', description: 'Python ë¹„ë™ê¸° ì›¹ í”„ë ˆì„ì›Œí¬' }),
            mkNode('e2', 'KuzuDB', 'Entity', { entity_type: 'technology', description: 'ì„ë² ë””ë“œ ê·¸ë˜í”„ ë°ì´í„°ë² ì´ìŠ¤' }),
            mkNode('e3', 'LangChain', 'Entity', { entity_type: 'technology', description: 'LLM ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ í”„ë ˆì„ì›Œí¬' }),
            mkNode('e4', 'Hybrid RAG', 'Entity', { entity_type: 'concept', description: 'ë²¡í„° + ê·¸ë˜í”„ + Cypher ê²°í•© ê²€ìƒ‰' }),
            mkNode('e5', 'Material 3', 'Entity', { entity_type: 'technology', description: 'Google ë””ìì¸ ì‹œìŠ¤í…œ' }),
            mkNode('e6', 'SpeakNode íŒ€', 'Entity', { entity_type: 'organization', description: 'í”„ë¡œì íŠ¸ ê°œë°œ ì¡°ì§' }),
            mkNode('e7', 'v5.2.0 ë§ˆì´ê·¸ë ˆì´ì…˜', 'Entity', { entity_type: 'event', description: '2025-02 API ì„œë²„ ì—…ê·¸ë ˆì´ë“œ ì¼ì •' }),
        ]);

        const edges = new vis.DataSet([
            mkEdge('m1', 't1', 'DISCUSSED'), mkEdge('m1', 't3', 'DISCUSSED'),
            mkEdge('m1', 't4', 'DISCUSSED'), mkEdge('m2', 't2', 'DISCUSSED'),
            mkEdge('p1', 't1', 'PROPOSED'), mkEdge('p2', 't3', 'PROPOSED'),
            mkEdge('p3', 't2', 'PROPOSED'), mkEdge('p4', 't4', 'PROPOSED'),
            mkEdge('p2', 'tk1', 'ASSIGNED_TO'), mkEdge('p4', 'tk2', 'ASSIGNED_TO'),
            mkEdge('p3', 'tk3', 'ASSIGNED_TO'), mkEdge('p2', 'tk4', 'ASSIGNED_TO'),
            mkEdge('t1', 'd1', 'RESULTED_IN'), mkEdge('t2', 'd2', 'RESULTED_IN'),
            mkEdge('p1', 'u1', 'SPOKE'), mkEdge('p4', 'u2', 'SPOKE'),
            mkEdge('p3', 'u3', 'SPOKE'), mkEdge('p2', 'u4', 'SPOKE'),
            mkEdge('p4', 'u5', 'SPOKE'), mkEdge('p3', 'u6', 'SPOKE'),
            mkEdge('m1', 'u1', 'CONTAINS'), mkEdge('m1', 'u2', 'CONTAINS'),
            mkEdge('m2', 'u3', 'CONTAINS'), mkEdge('m1', 'u4', 'CONTAINS'),
            mkEdge('m1', 'u5', 'CONTAINS'), mkEdge('m2', 'u6', 'CONTAINS'),
            mkEdge('m1', 'tk1', 'HAS_TASK'), mkEdge('m1', 'tk2', 'HAS_TASK'),
            mkEdge('m2', 'tk3', 'HAS_TASK'), mkEdge('m1', 'tk4', 'HAS_TASK'),
            mkEdge('m1', 'd1', 'HAS_DECISION'), mkEdge('m2', 'd2', 'HAS_DECISION'),
            mkEdge('u1', 'u2', 'NEXT'), mkEdge('u2', 'u4', 'NEXT'),
            mkEdge('u3', 'u6', 'NEXT'), mkEdge('u4', 'u5', 'NEXT'),
            // Entity edges: HAS_ENTITY (Meetingâ†’Entity)
            mkEdge('m1', 'e1', 'HAS_ENTITY'), mkEdge('m1', 'e2', 'HAS_ENTITY'),
            mkEdge('m1', 'e3', 'HAS_ENTITY'), mkEdge('m1', 'e4', 'HAS_ENTITY'),
            mkEdge('m1', 'e7', 'HAS_ENTITY'), mkEdge('m2', 'e5', 'HAS_ENTITY'),
            mkEdge('m1', 'e6', 'HAS_ENTITY'), mkEdge('m2', 'e6', 'HAS_ENTITY'),
            // Entity edges: MENTIONS (Topicâ†’Entity)
            mkEdge('t1', 'e1', 'MENTIONS'), mkEdge('t1', 'e7', 'MENTIONS'),
            mkEdge('t3', 'e4', 'MENTIONS'), mkEdge('t3', 'e3', 'MENTIONS'),
            mkEdge('t2', 'e5', 'MENTIONS'), mkEdge('t4', 'e2', 'MENTIONS'),
            // Entity edges: RELATED_TO (Entityâ†’Entity)
            mkEdge('e1', 'e7', 'RELATED_TO'), mkEdge('e3', 'e4', 'RELATED_TO'),
            mkEdge('e2', 'e4', 'RELATED_TO'), mkEdge('e5', 'e6', 'RELATED_TO'),
        ]);

        // vis-network Init
        const container = document.getElementById('graph-canvas');
        const network = new vis.Network(container, { nodes, edges }, {
            physics: {
                solver: 'forceAtlas2Based',
                forceAtlas2Based: { gravitationalConstant: -80, centralGravity: 0.006, springLength: 160, springConstant: 0.05, damping: 0.45 },
                stabilization: { iterations: 180, fit: true }
            },
            interaction: { hover: true, tooltipDelay: 150, zoomView: true, dragView: true },
            edges: { selectionWidth: 2 },
            nodes: { chosen: { node: function (v) { v.shadowSize = 14; v.borderWidth = 2.5 } } }
        });

        // Stats
        document.getElementById('stat-nodes').textContent = nodes.length;
        document.getElementById('stat-edges').textContent = edges.length;
        document.getElementById('status-bar').textContent =
            'SpeakNode Knowledge Graph | Nodes: ' + nodes.length + ' | Edges: ' + edges.length + ' | Status: Ready';

        // Click â†’ Node Detail
        network.on('click', function (params) {
            const panel = document.getElementById('node-detail');
            if (!params.nodes.length) { panel.classList.remove('visible'); return; }
            const n = nodes.get(params.nodes[0]);
            if (!n) return;
            const cfg = NODE_CFG[n._type];
            document.getElementById('detail-title').textContent = cfg.icon + ' ' + n.label.replace(cfg.icon + ' ', '');
            document.getElementById('detail-title').style.color = cfg.color;
            let html = '<div class="field"><span class="field-label">Type</span><span style="color:' + cfg.color + '">' + n._type + '</span></div>';
            const statusColors = { pending: '#f59e0b', in_progress: '#06b6d4', done: '#22c55e', blocked: '#ef4444' };
            for (const [k, v] of Object.entries(n._extra || {})) {
                if (v === undefined || v === null || v === '') continue;
                let dv = v;
                if (k === 'status') dv = '<span style="color:' + (statusColors[v] || '#e5e7eb') + '">' + v + '</span>';
                html += '<div class="field"><span class="field-label">' + k + '</span><span>' + dv + '</span></div>';
            }
            html += '<div class="field"><span class="field-label">Connections</span><span>' + network.getConnectedNodes(params.nodes[0]).length + '</span></div>';
            document.getElementById('detail-fields').innerHTML = html;
            panel.classList.add('visible');
        });

        network.on('doubleClick', function (params) {
            if (params.nodes.length) network.focus(params.nodes[0], { scale: 1.5, animation: { duration: 600, easingFunction: 'easeInOutQuad' } });
        });
    </script>
</body>

</html>
